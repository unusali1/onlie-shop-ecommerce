{"ast":null,"code":"import _toConsumableArray from\"E:/Ecommerce/ecomern-frontend-main/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"E:/Ecommerce/ecomern-frontend-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{Alert,Col,Container,Form,Row,Button}from\"react-bootstrap\";import{useNavigate,useParams}from\"react-router-dom\";import{useUpdateProductMutation}from\"../services/appApi\";import axios from\"../axios\";import\"./NewProduct.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EditProductPage(){var _useParams=useParams(),id=_useParams.id;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),description=_useState4[0],setDescription=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),price=_useState6[0],setPrice=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),category=_useState8[0],setCategory=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),images=_useState10[0],setImages=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),imgToRemove=_useState12[0],setImgToRemove=_useState12[1];var navigate=useNavigate();var _useUpdateProductMuta=useUpdateProductMutation(),_useUpdateProductMuta2=_slicedToArray(_useUpdateProductMuta,2),updateProduct=_useUpdateProductMuta2[0],_useUpdateProductMuta3=_useUpdateProductMuta2[1],isError=_useUpdateProductMuta3.isError,error=_useUpdateProductMuta3.error,isLoading=_useUpdateProductMuta3.isLoading,isSuccess=_useUpdateProductMuta3.isSuccess;useEffect(function(){axios.get(\"/products/\"+id).then(function(_ref){var data=_ref.data;var product=data.product;setName(product.name);setDescription(product.description);setCategory(product.category);setImages(product.pictures);setPrice(product.price);}).catch(function(e){return console.log(e);});},[id]);function handleRemoveImg(imgObj){setImgToRemove(imgObj.public_id);axios.delete(\"/images/\".concat(imgObj.public_id,\"/\")).then(function(res){setImgToRemove(null);setImages(function(prev){return prev.filter(function(img){return img.public_id!==imgObj.public_id;});});}).catch(function(e){return console.log(e);});}function handleSubmit(e){e.preventDefault();if(!name||!description||!price||!category||!images.length){return alert(\"Please fill out all the fields\");}updateProduct({id:id,name:name,description:description,price:price,category:category,images:images}).then(function(_ref2){var data=_ref2.data;if(data.length>0){setTimeout(function(){navigate(\"/\");},1500);}});}function showWidget(){var widget=window.cloudinary.createUploadWidget({cloudName:\"your-cloudname\",uploadPreset:\"your-preset\"},function(error,result){if(!error&&result.event===\"success\"){setImages(function(prev){return[].concat(_toConsumableArray(prev),[{url:result.info.url,public_id:result.info.public_id}]);});}});widget.open();}return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,className:\"new-product__form--container\",children:/*#__PURE__*/_jsxs(Form,{style:{width:\"100%\"},onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mt-4\",children:\"Edit product\"}),isSuccess&&/*#__PURE__*/_jsx(Alert,{variant:\"success\",children:\"Product updated\"}),isError&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:error.data}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Product name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Enter product name\",value:name,required:true,onChange:function onChange(e){return setName(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Product description\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",placeholder:\"Product description\",style:{height:\"100px\"},value:description,required:true,onChange:function onChange(e){return setDescription(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Price(\\u09F3)\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"Price (\\u09F3)\",value:price,required:true,onChange:function onChange(e){return setPrice(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",onChange:function onChange(e){return setCategory(e.target.value);},children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Category\"}),/*#__PURE__*/_jsxs(Form.Select,{value:category,children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,selected:true,children:\"-- Select One --\"}),/*#__PURE__*/_jsx(\"option\",{value:\"technology\",children:\"technology\"}),/*#__PURE__*/_jsx(\"option\",{value:\"tablets\",children:\"tablets\"}),/*#__PURE__*/_jsx(\"option\",{value:\"phones\",children:\"phones\"}),/*#__PURE__*/_jsx(\"option\",{value:\"laptops\",children:\"laptops\"})]})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Button,{type:\"button\",onClick:showWidget,children:\"Upload Images\"}),/*#__PURE__*/_jsx(\"div\",{className:\"images-preview-container\",children:images.map(function(image){return/*#__PURE__*/_jsxs(\"div\",{className:\"image-preview\",children:[/*#__PURE__*/_jsx(\"img\",{src:image.url,alt:\"not found\"}),imgToRemove!==image.public_id&&/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-times-circle\",onClick:function onClick(){return handleRemoveImg(image);}})]});})})]}),/*#__PURE__*/_jsx(Form.Group,{children:/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:isLoading||isSuccess,children:\"Update Product\"})})]})}),/*#__PURE__*/_jsx(Col,{md:6,className:\"new-product__image--container\"})]})});}export default EditProductPage;","map":{"version":3,"names":["React","useEffect","useState","Alert","Col","Container","Form","Row","Button","useNavigate","useParams","useUpdateProductMutation","axios","EditProductPage","id","name","setName","description","setDescription","price","setPrice","category","setCategory","images","setImages","imgToRemove","setImgToRemove","navigate","updateProduct","isError","error","isLoading","isSuccess","get","then","data","product","pictures","catch","e","console","log","handleRemoveImg","imgObj","public_id","delete","res","prev","filter","img","handleSubmit","preventDefault","length","alert","setTimeout","showWidget","widget","window","cloudinary","createUploadWidget","cloudName","uploadPreset","result","event","url","info","open","width","target","value","height","map","image"],"sources":["E:/Ecommerce/ecomern-frontend-main/src/pages/EditProductPage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Alert, Col, Container, Form, Row, Button } from \"react-bootstrap\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { useUpdateProductMutation } from \"../services/appApi\";\nimport axios from \"../axios\";\nimport \"./NewProduct.css\";\n\nfunction EditProductPage() {\n    const { id } = useParams();\n    const [name, setName] = useState(\"\");\n    const [description, setDescription] = useState(\"\");\n    const [price, setPrice] = useState(\"\");\n    const [category, setCategory] = useState(\"\");\n    const [images, setImages] = useState([]);\n    const [imgToRemove, setImgToRemove] = useState(null);\n    const navigate = useNavigate();\n    const [updateProduct, { isError, error, isLoading, isSuccess }] = useUpdateProductMutation();\n\n    useEffect(() => {\n        axios\n            .get(\"/products/\" + id)\n            .then(({ data }) => {\n                const product = data.product;\n                setName(product.name);\n                setDescription(product.description);\n                setCategory(product.category);\n                setImages(product.pictures);\n                setPrice(product.price);\n            })\n            .catch((e) => console.log(e));\n    }, [id]);\n\n    function handleRemoveImg(imgObj) {\n        setImgToRemove(imgObj.public_id);\n        axios\n            .delete(`/images/${imgObj.public_id}/`)\n            .then((res) => {\n                setImgToRemove(null);\n                setImages((prev) => prev.filter((img) => img.public_id !== imgObj.public_id));\n            })\n            .catch((e) => console.log(e));\n    }\n\n    function handleSubmit(e) {\n        e.preventDefault();\n        if (!name || !description || !price || !category || !images.length) {\n            return alert(\"Please fill out all the fields\");\n        }\n        updateProduct({ id, name, description, price, category, images }).then(({ data }) => {\n            if (data.length > 0) {\n                setTimeout(() => {\n                    navigate(\"/\");\n                }, 1500);\n            }\n        });\n    }\n\n    function showWidget() {\n        const widget = window.cloudinary.createUploadWidget(\n            {\n                cloudName: \"your-cloudname\",\n                uploadPreset: \"your-preset\",\n            },\n            (error, result) => {\n                if (!error && result.event === \"success\") {\n                    setImages((prev) => [...prev, { url: result.info.url, public_id: result.info.public_id }]);\n                }\n            }\n        );\n        widget.open();\n    }\n\n    return (\n        <Container>\n            <Row>\n                <Col md={6} className=\"new-product__form--container\">\n                    <Form style={{ width: \"100%\" }} onSubmit={handleSubmit}>\n                        <h1 className=\"mt-4\">Edit product</h1>\n                        {isSuccess && <Alert variant=\"success\">Product updated</Alert>}\n                        {isError && <Alert variant=\"danger\">{error.data}</Alert>}\n                        <Form.Group className=\"mb-3\">\n                            <Form.Label>Product name</Form.Label>\n                            <Form.Control type=\"text\" placeholder=\"Enter product name\" value={name} required onChange={(e) => setName(e.target.value)} />\n                        </Form.Group>\n\n                        <Form.Group className=\"mb-3\">\n                            <Form.Label>Product description</Form.Label>\n                            <Form.Control as=\"textarea\" placeholder=\"Product description\" style={{ height: \"100px\" }} value={description} required onChange={(e) => setDescription(e.target.value)} />\n                        </Form.Group>\n\n                        <Form.Group className=\"mb-3\">\n                            <Form.Label>Price(৳)</Form.Label>\n                            <Form.Control type=\"number\" placeholder=\"Price (৳)\" value={price} required onChange={(e) => setPrice(e.target.value)} />\n                        </Form.Group>\n\n                        <Form.Group className=\"mb-3\" onChange={(e) => setCategory(e.target.value)}>\n                            <Form.Label>Category</Form.Label>\n                            <Form.Select value={category}>\n                                <option disabled selected>\n                                    -- Select One --\n                                </option>\n                                <option value=\"technology\">technology</option>\n                                <option value=\"tablets\">tablets</option>\n                                <option value=\"phones\">phones</option>\n                                <option value=\"laptops\">laptops</option>\n                            </Form.Select>\n                        </Form.Group>\n\n                        <Form.Group className=\"mb-3\">\n                            <Button type=\"button\" onClick={showWidget}>\n                                Upload Images\n                            </Button>\n                            <div className=\"images-preview-container\">\n                                {images.map((image) => (\n                                    <div className=\"image-preview\">\n                                        <img src={image.url} alt=\"not found\" />\n                                        {imgToRemove !== image.public_id && <i className=\"fa fa-times-circle\" onClick={() => handleRemoveImg(image)}></i>}\n                                    </div>\n                                ))}\n                            </div>\n                        </Form.Group>\n\n                        <Form.Group>\n                            <Button type=\"submit\" disabled={isLoading || isSuccess}>\n                                Update Product\n                            </Button>\n                        </Form.Group>\n                    </Form>\n                </Col>\n                <Col md={6} className=\"new-product__image--container\"></Col>\n            </Row>\n        </Container>\n    );\n}\n\nexport default EditProductPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}